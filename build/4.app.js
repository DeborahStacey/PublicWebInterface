webpackJsonp([4],{555:function(e,t,a){try{(function(){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(1),s=l(r),u=(a(17),a(18)),n=a(32),o=a(556),i=l(o),c=a(30),d=l(c),m=s.default.createClass({displayName:"OpenDataset",getInitialState:function(){return{modalShow:!1,resourceList:[],resourceEditID:-1,error:""}},mixins:[n.History],handleSubmitPublish:function(e){e.preventDefault(),console.log("handleSubmitPublish");var t=[],a="";if(""==e.target.title.value&&t.push("Title"),""==e.target.publisher.value&&t.push("Publisher"),""==e.target.subject.value&&t.push("Subject"),""==e.target.description.value&&t.push("Description"),t.length>0){for(var l=0;l<t.length;l++){var r=", ";0==l&&(r="",a+=r+t[l])}var s={errorType:"Publish Dataset",errorLocation:"Publish Dataset",errotCode:"008",errorMessage:"The following field(s) are required: "+a};this.setState({error:s})}else{var u={title:e.target.title.value,publisher:e.target.publisher.value,subject:e.target.subject.value,description:e.target.description.value,license:e.target.license.value,keywords:e.target.keywords.value,resourceList:this.state.resourceList},n=new FormData;d.default.each(u,function(e,t){n.append(e,t)}),n.append("resourceLength",this.state.resourceList.length);for(var o in u)if("resourceList"!=o)n.append(o,u[o]);else if("resourceList"==o){var l=0;for(l=0;l<u[o].length;l++)n.append("resource"+l+"Name",u[o][l].resourceName),n.append("resource"+l+"Format",u[o][l].format),n.append("resource"+l+"Language",u[o][l].language),n.append("resource"+l+"File",u[o][l].file),n.append("resource"+l+"FileName",u[o][l].fileName)}d.default.ajax({url:"http://localhost:8888/wellcat/publishdataset.php",type:"POST",data:n,cache:!1,processData:!1,contentType:!1,success:function(e,t,a){if("undefined"==typeof e.error){var l=JSON.parse(e);alert("Success published a dataset! You will be redirect to the dataset."),this.props.history.pushState(null,"/dashboard/OpenDataSet?RecordID="+l.recordID)}else console.log("ERRORS: "+e.error)}.bind(this),error:function(e,t,a){console.log("ERRORS: "+t)}})}},getResource:function(e,t){var a=[];0==this.state.resourceList.length?a.push(e):(a=this.state.resourceList.slice(),t>=0?a[t]=e:a.push(e)),this.setState({resourceList:a,resourceEditID:-1})},clearEditID:function(){this.setState({resourceEditID:-1})},changeEditID:function(e){this.setState({modalShow:!0,resourceEditID:e.target.value})},deleteResource:function(e){var t=[];t=this.state.resourceList.slice(),t.splice(e.target.value,1),this.setState({resourceList:t,resourceEditID:-1})},generateResourceListTable:function(){var e=this,t="",t=s.default.createElement("div",null,s.default.createElement("label",{htmlFor:"Resources"},"Resources"),s.default.createElement(u.Table,{striped:!0,bordered:!0,condensed:!0,hover:!0},s.default.createElement("thead",null,s.default.createElement("tr",null,s.default.createElement("th",null,"Resource Name"),s.default.createElement("th",null,"Format"),s.default.createElement("th",null,"Language"),s.default.createElement("th",null,"File"),s.default.createElement("th",null,"Edit"),s.default.createElement("th",null,"Delete"))),s.default.createElement("tbody",null,this.state.resourceList.map(function(e,t){return s.default.createElement("tr",{key:t},s.default.createElement("td",null,e.resourceName),s.default.createElement("td",null,s.default.createElement("span",{className:"badge"},e.format)),s.default.createElement("td",null,e.language),s.default.createElement("td",null,e.fileName),s.default.createElement("td",null,s.default.createElement(u.Button,{value:t,bsStyle:"primary",onClick:this.changeEditID},"Edit")),s.default.createElement("td",null,s.default.createElement(u.Button,{value:t,bsStyle:"danger",onClick:this.deleteResource},"Delete")))},this),s.default.createElement("tr",{style:{textAlign:"center"}},s.default.createElement("td",{colSpan:"6",style:{textAlign:"center"}},s.default.createElement(u.Button,{value:"add",bsStyle:"warning",onClick:function(){return e.setState({modalShow:!0,resourceEditID:-1})}},"Add New Resource"))))));return t},getErrorDisplay:function(){return console.log("print error message",this.state.error),s.default.createElement("div",null,s.default.createElement("br",null),s.default.createElement("div",{className:"alert alert-danger",role:"alert"},s.default.createElement("span",{className:"glyphicon glyphicon-exclamation-sign","aria-hidden":"true"}),this.state.error.errorMessage))},render:function(){var e=this,t=function(){return e.setState({modalShow:!1})};return s.default.createElement("div",{className:"faq-page",key:"faq"},s.default.createElement("div",{className:"page-header"},s.default.createElement("h1",null,"Publish Dataset")),s.default.createElement(u.Well,null,s.default.createElement("span",{className:"glyphicon glyphicon-info-sign","aria-hidden":"true"})," Welcome to Publish Dataset page. This functionality is for Wellcat admin only. Fill out each fields, add data resources below, and press submit to publish dataset."),s.default.createElement(u.Panel,{bsStyle:"primary",header:s.default.createElement("span",null,"Publish New Dataset")},s.default.createElement("form",{onSubmit:this.handleSubmitPublish},s.default.createElement("div",{className:"form-group"},s.default.createElement("label",null,"Title"),s.default.createElement("span",{className:"requiredField"},"*"),s.default.createElement("input",{type:"text",name:"title",className:"form-control",placeholder:"Title",required:!0})),s.default.createElement("div",{className:"form-group"},s.default.createElement("label",null,"Publisher"),s.default.createElement("span",{className:"requiredField"},"*"),s.default.createElement("input",{type:"text",name:"publisher",className:"form-control",placeholder:"Publisher",required:!0})),s.default.createElement("div",{className:"form-group"},s.default.createElement("label",null,"Subject"),s.default.createElement("span",{className:"requiredField"},"*"),s.default.createElement("input",{type:"text",name:"subject",className:"form-control",placeholder:"Subject",required:!0})),s.default.createElement("div",{className:"form-group"},s.default.createElement("label",null,"Description"),s.default.createElement("span",{className:"requiredField"},"*"),s.default.createElement("textarea",{className:"form-control",name:"description",rows:"5",id:"description",placeholder:"Description",required:!0})),s.default.createElement("div",{className:"form-group"},s.default.createElement("label",null,"License"),s.default.createElement("span",{className:"requiredField"},"*"),s.default.createElement("input",{type:"text",name:"license",className:"form-control",placeholder:"License",required:!0})),s.default.createElement("div",{className:"form-group"},s.default.createElement("label",null,"Keywords"),s.default.createElement("input",{type:"text",name:"keywords",className:"form-control",placeholder:"Enter keywords to help search the dataset. Seperate by comma."})),this.generateResourceListTable(),"Publish Dataset"==this.state.error.errorLocation?this.getErrorDisplay():"",s.default.createElement(u.Row,{style:{textAlign:"center"}},s.default.createElement(u.Col,{md:6},s.default.createElement(u.Button,{value:"Submit",type:"submit",bsStyle:"success"},"Create")),s.default.createElement(u.Col,{md:6},s.default.createElement(u.Button,{href:"#dashboard/OpenDataset",value:"Cancel",bsStyle:"default"},"Cancel")))),s.default.createElement(i.default,{show:this.state.modalShow,onHide:t,submitResource:this.getResource,resource:this.state.resourceEditID>=0?this.state.resourceList[this.state.resourceEditID]:"",clearEditID:this.clearEditID,editID:this.state.resourceEditID})))}});t.default=m,e.exports=t.default}).call(this)}finally{}},556:function(e,t,a){try{(function(){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},s=a(1),u=l(s),n=(a(17),a(18)),o=a(30),i=(l(o),u.default.createClass({displayName:"PublishDatasetModal",getInitialState:function(){return{status:"",error:"",file:""}},handleAdResource:function(e){e.preventDefault(),console.log("........Modal");var t=[],a="";if(""==e.target.resourceName.value&&t.push("Resource Name"),""==e.target.format.value&&t.push("File Format"),""==e.target.language.value&&t.push("Language"),""==e.target.uploadFile.value&&(this.props.resource||t.push("Upload File")),t.length>0){console.log("errors");for(var l=0;l<t.length;l++){var r=", ";0==l&&(r="",a+=r+t[l])}var s={errorType:"Add Resource",errorLocation:"Add Resource",errotCode:"008",errorMessage:"The following field(s) are required: "+a};this.setState({error:s})}else{console.log("........no error");var u=(document.getElementById("uploadFile"),""),n="";""!=this.state.file?(u=this.state.file,n=e.target.uploadFile.value.replace(/^.*[\\\/]/,"")):this.props.resource&&(u=this.props.resource.file,n=this.props.resource.fileName,console.log("handle add resource  edit mode"));var o={resourceName:e.target.resourceName.value,format:e.target.format.value,language:e.target.language.value,file:u,fileName:n};this.props.submitResource(o,this.props.editID),this.setState({status:"sent",file:"",error:""})}},handleClose:function(){this.props.clearEditID(),this.setState({status:"",error:""}),this.props.onHide()},handleFileSelected:function(e){var t=this,a=new FileReader,l=e.target.files[0];a.onloadend=function(){t.setState({file:l})},a.readAsDataURL(l)},getErrorDisplay:function(){return console.log("print error message",this.state.error),u.default.createElement("div",null,u.default.createElement("br",null),u.default.createElement("div",{className:"alert alert-danger",role:"alert"},u.default.createElement("span",{className:"glyphicon glyphicon-exclamation-sign","aria-hidden":"true"}),this.state.error.errorMessage))},createBody:function(){return"sent"==this.state.status?u.default.createElement("div",null,u.default.createElement(n.Modal.Body,null,u.default.createElement("p",null,"Resource is added to resource list.")),u.default.createElement(n.Modal.Footer,null,u.default.createElement(n.Button,{onClick:this.handleClose},"Close"))):u.default.createElement("div",null,u.default.createElement("form",{onSubmit:this.handleAdResource},u.default.createElement(n.Modal.Body,null,u.default.createElement("div",{className:"form-group"},u.default.createElement("label",null,"Resource Name"),u.default.createElement("span",{className:"requiredField"},"*"),u.default.createElement("input",{type:"text",name:"resourceName",className:"form-control",placeholder:"Resource Name",defaultValue:this.props.resource?this.props.resource.resourceName:"",required:!0})),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",null,"Format (xls, xlsx, json, pdf, csv)"),u.default.createElement("span",{className:"requiredField"},"*"),u.default.createElement("input",{type:"text",name:"format",className:"form-control",placeholder:"Format",defaultValue:this.props.resource?this.props.resource.format:"",required:!0})),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",null,"Language"),u.default.createElement("span",{className:"requiredField"},"*"),u.default.createElement("input",{type:"text",name:"language",className:"form-control",placeholder:"Language",defaultValue:this.props.resource?this.props.resource.language:"",required:!0})),u.default.createElement("div",{className:"form-group"},this.props.resource?u.default.createElement("span",null,u.default.createElement("label",null,"Existing file: "),this.props.resource.fileName," (Upload new file below to replace existing file)",u.default.createElement("br",null)):"",u.default.createElement("label",null,"Upload New File (accept .xls, .xlsx, .json, .pdf, .csv)"),u.default.createElement("span",{className:"requiredField"},"*"),u.default.createElement("br",null),u.default.createElement("input",{type:"file",accept:".xls,.xlsx,.json,.pdf,.csv",id:"uploadFile",name:"uploadFile",className:"form-control",placeholder:"Upload New File",onChange:this.handleFileSelected,required:!this.props.resource})),"Add Resource"==this.state.error.errorLocation?this.getErrorDisplay():""),u.default.createElement(n.Modal.Footer,null,u.default.createElement(n.Button,{value:"Add",type:"submit",bsStyle:"primary"},"Add"),u.default.createElement(n.Button,{onClick:this.props.onHide},"Close"))))},render:function(){return u.default.createElement("div",null,u.default.createElement(n.Modal,r({},this.props,{"aria-labelledby":"contained-modal-title-sm"}),u.default.createElement(n.Modal.Header,{closeButton:!0},u.default.createElement(n.Modal.Title,{id:"contained-modal-title-sm"},"Add New Resource")),this.createBody()))}}));t.default=i,e.exports=t.default}).call(this)}finally{}}});